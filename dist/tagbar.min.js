!function(f){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=f();else if("function"==typeof define&&define.amd)define([],f);else{var g;g="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,g.Tagbar=f()}}(function(){return function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a="function"==typeof require&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}for(var i="function"==typeof require&&require,o=0;o<r.length;o++)s(r[o]);return s}({1:[function(require,module){var VK_BACKSPACE=8,VK_RETURN=13,VK_SPACE=32,VK_LEFT=37,VK_UP=38,VK_DOWN=40,VK_DELETE=46,Tagbar=function(options){this.container=document.getElementById(options.container),this.onAdd="function"==typeof options.onAdd?options.onAdd:function(){},this.onRemove="function"==typeof options.onRemove?options.onRemove:function(){},this.onSuggest="function"==typeof options.onSuggest?options.onSuggest:function(){},this.tags=[],this.selectedTag=0,this.prevPos=-1,this.sugs=[],this.selectedSug=null,this.createNodes(),this.attachEventListeners(),this.resizeInput(),this.container.appendChild(this.node)};module.exports=Tagbar,Tagbar.prototype.createNodes=function(){this.node=document.createElement("div"),this.node.className="tagbar",this.oList=document.createElement("span"),this.oList.className="list",this.node.appendChild(this.oList),this.oInput=document.createElement("input"),this.oInput.type="text",this.oInput.setAttribute("autocomplete","off"),this.oInput.setAttribute("autocorrect","off"),this.oInput.setAttribute("autocapitalize","off"),this.oInput.setAttribute("spellcheck","false");var oSpan=document.createElement("span");oSpan.className="input",oSpan.appendChild(this.oInput),this.oSugs=document.createElement("div"),this.oSugs.className="sugs",oSpan.appendChild(this.oSugs),this.node.appendChild(oSpan)},Tagbar.prototype.attachEventListeners=function(){this.node.addEventListener("click",this.onNodeClick.bind(this)),this.oInput.addEventListener("input",this.onInput.bind(this)),this.oInput.addEventListener("keydown",this.onKeydown.bind(this)),this.oInput.addEventListener("keyup",this.onKeyup.bind(this)),this.oList.addEventListener("click",this.onListClick.bind(this)),this.oSugs.addEventListener("click",this.onSugsClick.bind(this)),window.addEventListener("mousedown",this.onWindowDown.bind(this)),window.addEventListener("touchstart",this.onWindowDown.bind(this))},Tagbar.prototype.destroy=function(){this.detachEventListeners(),this.container.removeChild(this.node),this.node=null},Tagbar.prototype.detachEventListeners=function(){window.removeEventListener("mousedown",this.onWindowDown),window.removeEventListener("touchstart",this.onWindowDown)},Tagbar.prototype.onNodeClick=function(){var tagbar=this;tagbar.deselectTag(),tagbar.oInput.focus()},Tagbar.prototype.onInput=function(){var tagbar=this;tagbar.deselectTag();var query=tagbar.oInput.value;query.length?tagbar.search(query):tagbar.hideSugs()},Tagbar.prototype.onWindowDown=function(e){for(var tagbar=this,node=e.target,inside=!1;node;){if(node==tagbar.node){inside=!0;break}node=node.parentNode}if(!inside&&(tagbar.deselectTag(),tagbar.hideSugs(),tagbar.oInput.value.length>0)){var newTag=tagbar.oInput.value.split(" ")[0];tagbar.addTag(newTag),tagbar.oInput.value="",tagbar.resizeInput()}},Tagbar.prototype.androidBackspace=function(code){return 229!=code&&0!=code||0!=this.oInput.value.length?!1:!0},Tagbar.prototype.onKeydown=function(e){var tagbar=this;if(e.which===VK_UP)tagbar.selectPrevSug(),e.preventDefault();else if(e.which===VK_DOWN)tagbar.selectNextSug(),e.preventDefault();else if(e.which===VK_RETURN||e.which===VK_SPACE||e.target.value.indexOf(" ")>=0){e.preventDefault();var newTag;tagbar.hideSugs(),newTag=tagbar.selectedSug?tagbar.selectedSug.tag:e.target.value.split(" ")[0],tagbar.addTag(newTag),e.target.value="",tagbar.resizeInput()}else if(e.which==VK_LEFT){var pos=this.getCaretPos(tagbar.oInput);0==pos&&0==tagbar.prevPos&&tagbar.tags.length&&tagbar.selectTag(tagbar.tags[tagbar.tags.length-1]),tagbar.prevPos=pos}else e.which==VK_BACKSPACE||tagbar.androidBackspace(e.which)?tagbar.selectedTag?(tagbar.removeTag(tagbar.selectedTag),tagbar.selectedTag=null):0==tagbar.oInput.value.length&&tagbar.tags.length&&tagbar.selectTag(tagbar.tags[tagbar.tags.length-1]):e.which==VK_DELETE&&tagbar.selectedTag&&(tagbar.removeTag(tagbar.selectedTag),tagbar.selectedTag=null,e.preventDefault());e.which!=VK_DELETE&&e.which!=VK_LEFT&&tagbar.selectedTag&&tagbar.oInput.value.length>0&&tagbar.deselectTag()},Tagbar.prototype.onKeyup=function(){var tagbar=this;tagbar.resizeInput()},Tagbar.prototype.onListClick=function(e){var tagbar=this;if(tagbar.oInput.focus(),e.target!=tagbar.oList&&"SPAN"==e.target.nodeName){var tag=tagbar.findTagByNode(e.target);tagbar.selectTag(tag),e.stopPropagation()}},Tagbar.prototype.onSugsClick=function(e){var tagbar=this,sug=tagbar.getSugByNode(e.target);sug&&(tagbar.addTag(sug.tag),tagbar.oInput.value="",tagbar.resizeInput(),tagbar.hideSugs(),tagbar.focus()),e.stopPropagation()},Tagbar.prototype.getCaretPos=function(input){var pos=0;if(document.selection){var selection=document.selection.createRange();selection.moveStart("character",-input.value.length),pos=selection.text.length}else(input.selectionStart||"0"==input.selectionStart)&&(pos=input.selectionStart);return pos},Tagbar.prototype.hasTag=function(name){for(var i=0;i<this.tags.length;i++){var tag=this.tags[i];if(tag.name==name)return!0}return!1},Tagbar.prototype.addTag=function(name){name=name.toLowerCase(),name.length&&(this.hasTag(name)||(this.tags.push({name:name,node:null}),this.render(),this.onAdd(name)))},Tagbar.prototype.setTags=function(names){this.tags=[];for(var i=0;i<names.length;i++){var name=names[i];this.tags.push({name:name,node:null})}this.render()},Tagbar.prototype.removeTag=function(tag){var n=this.tags.indexOf(tag);n>=0&&(this.tags.splice(n,1),this.render(),this.onRemove(tag.name))},Tagbar.prototype.getTagList=function(){for(var list=[],i=0;i<this.tags.length;i++)list.push(this.tags[i].name);return list},Tagbar.prototype.render=function(){for(this.selectedTag=null;this.oList.firstChild;)this.oList.removeChild(this.oList.firstChild);for(var oList=document.createDocumentFragment(),i=0;i<this.tags.length;i++){var tag=this.tags[i],span=document.createElement("span"),text=document.createTextNode(tag.name);span.appendChild(text),span.setAttribute("title",tag.name),oList.appendChild(span),text=document.createTextNode(" "),oList.appendChild(text),tag.node=span}this.oList.appendChild(oList),this.tags.length?this.oInput.setAttribute("placeholder",""):this.oInput.setAttribute("placeholder","tags")},Tagbar.prototype.findTagByNode=function(node){for(var i=0;i<this.tags.length;i++){var tag=this.tags[i];if(tag.node==node)return tag}return 0},Tagbar.prototype.selectTag=function(tag){this.selectedTag&&(this.selectedTag.node.className="",this.selectedTag=null),tag.node.className="selected",this.selectedTag=tag},Tagbar.prototype.deselectTag=function(){this.selectedTag&&(this.selectedTag.node.className="",this.selectedTag=null)},Tagbar.prototype.resizeInput=function(){var len=this.oInput.value.length;4>len&&(len=4),this.oInput.setAttribute("size",len+1)},Tagbar.prototype.focus=function(){this.oInput.focus()},Tagbar.prototype.renderSugs=function(tags){this.sugs=[],this.selectedSug=null;for(var oTmp=document.createDocumentFragment(),n=0,i=0;i<tags.length&&6>n;i++){var tag=tags[i];if(!this.hasTag(tag)){var oTag=document.createElement("div");oTag.appendChild(document.createTextNode(tag)),oTmp.appendChild(oTag),this.sugs.push({tag:tag,node:oTag}),n++}}this.oSugs.innerHTML="",this.oSugs.appendChild(oTmp),tags.length?this.showSugs():this.hideSugs()},Tagbar.prototype.search=function(query){var tagbar=this;this.onSuggest(query,function(tags){tagbar.renderSugs(tags)})},Tagbar.prototype.selectNextSug=function(){if(this.sugs.length){var i=0;this.selectedSug&&(this.selectedSug.node.className="",i=this.sugs.indexOf(this.selectedSug),i++),i<this.sugs.length&&(this.selectedSug=this.sugs[i]),this.selectedSug.node.className="selected"}},Tagbar.prototype.selectPrevSug=function(){var i=-1;this.selectedSug&&(this.selectedSug.node.className="",i=this.sugs.indexOf(this.selectedSug),i--),i>=0?(this.selectedSug=this.sugs[i],this.selectedSug.node.className="selected"):this.selectedSug=null},Tagbar.prototype.getSugByNode=function(node){for(var i=0;i<this.sugs.length;i++){var sug=this.sugs[i];if(sug.node==node)return sug}return null},Tagbar.prototype.showSugs=function(){this.oSugs.className="sugs"},Tagbar.prototype.hideSugs=function(){this.oSugs.className="sugs hide"}},{}]},{},[1])(1)});